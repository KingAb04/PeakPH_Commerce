# PeakPH Commerce - Admin Directory Security
# Restrict access to admin area and enforce additional security measures

# Block access to auth helper and sensitive files
<Files "auth_helper.php">
    Require all denied
</Files>

<Files "*_data.php">
    Require all denied
</Files>

# Deny access to backup and log files
<Files "*.log">
    Require all denied
</Files>

<Files "*.bak">
    Require all denied
</Files>

<Files "*.backup">
    Require all denied
</Files>

# Prevent access to configuration files
<Files "config.*">
    Require all denied
</Files>

# Prevent directory listing
Options -Indexes

# Block access to .htaccess file itself
<Files ".htaccess">
    Require all denied
</Files>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options SAMEORIGIN
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy strict-origin-when-cross-origin
</IfModule>

# Disable directory browsing
Options -Indexes

# Redirect root admin access to login
DirectoryIndex login.php

# Session security
<IfModule mod_php.c>
    php_value session.cookie_httponly 1
    php_value session.cookie_secure 1
    php_value session.use_only_cookies 1
</IfModule>